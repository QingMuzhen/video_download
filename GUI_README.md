# GUI 使用指南

## 启动 GUI

### 方式1：直接运行 Python 脚本
```bash
python gui.py
```

### 方式2：运行打包后的 exe 文件
```bash
# Windows
dist\视频爬虫工具.exe

# Linux/Mac
dist/视频爬虫工具
```

## 界面说明

### 1. URL 输入区域
- **视频URL输入框**：输入要下载的视频页面URL
- **粘贴按钮**：快速粘贴剪贴板中的URL

### 2. 基本设置
- **保存目录**：选择视频保存位置（默认：downloads）
- **最大下载数**：限制下载的视频数量（默认：10）
- **并发线程**：同时下载的线程数（默认：3，建议3-5）
- **搜索关键词**：过滤视频URL的关键词，用逗号分隔（如：1080p,high,quality）

### 3. 高级选项
- **强制使用抓包模式**：对所有URL使用浏览器抓包（适用于动态网站）
- **启用断点续传**：下载中断后可继续（默认开启）
- **自动合并音视频**：自动合并分离的音视频流（需要FFmpeg）
- **自动解密视频**：自动解密加密视频如webmask（默认开启）
- **无头浏览器模式**：后台运行浏览器，不显示窗口（默认开启）
- **使用代理**：配置HTTP/HTTPS代理服务器

### 4. 控制按钮
- **开始下载**：开始下载任务
- **停止下载**：停止当前下载任务
- **清空日志**：清空日志显示区域
- **打开下载目录**：快速打开保存目录

### 5. 进度显示
- **进度条**：显示整体下载进度
- **状态文本**：显示当前操作状态

### 6. 运行日志
- 实时显示下载过程中的详细信息
- 不同颜色表示不同级别：
  - 黑色：普通信息
  - 绿色：成功信息
  - 橙色：警告信息
  - 红色：错误信息

## 使用流程

### 基础使用
1. 在URL输入框中输入或粘贴视频页面地址
2. （可选）调整保存目录和下载数量
3. 点击"开始下载"按钮
4. 等待下载完成
5. 点击"打开下载目录"查看下载的视频

### 高级使用

#### 场景1：下载B站视频
1. 输入B站视频URL
2. 勾选"强制使用抓包模式"
3. 勾选"自动解密视频"（处理webmask格式）
4. 点击"开始下载"

#### 场景2：批量下载并过滤
1. 输入视频列表页面URL
2. 设置"最大下载数"为50
3. 在"搜索关键词"中输入：1080p,high
4. 设置"并发线程"为5
5. 点击"开始下载"

#### 场景3：使用代理下载
1. 勾选"使用代理"
2. 输入代理地址：http://127.0.0.1:7890
3. 输入视频URL
4. 点击"开始下载"

#### 场景4：下载HLS流媒体
1. 输入.m3u8链接
2. 程序会自动识别为HLS流
3. 自动下载并合并所有片段
4. 点击"开始下载"

## 打包成 EXE

### Windows 打包
```bash
# 运行打包脚本
build.bat

# 或手动打包
pyinstaller --clean video_downloader.spec
```

### Linux/Mac 打包
```bash
# 添加执行权限
chmod +x build.sh

# 运行打包脚本
./build.sh

# 或手动打包
pyinstaller --clean video_downloader.spec
```

### 打包后的文件结构
```
dist/
└── 视频爬虫工具.exe (或 视频爬虫工具)
    ├── 可执行文件
    ├── config.ini (配置文件)
    └── README.md (说明文档)
```

## 注意事项

### 1. 依赖要求
- **Python 3.7+**：运行Python脚本需要
- **Chrome浏览器**：使用抓包功能需要
- **ChromeDriver**：需要与Chrome版本匹配
- **FFmpeg**：合并音视频和解密需要

### 2. ChromeDriver 配置
下载地址：https://chromedriver.chromium.org/downloads

**方式1：系统PATH**
- 将ChromeDriver添加到系统PATH环境变量

**方式2：同目录**
- 将ChromeDriver.exe放在程序同一目录

### 3. FFmpeg 配置
下载地址：https://ffmpeg.org/download.html

**方式1：系统PATH**
- 将FFmpeg添加到系统PATH环境变量

**方式2：同目录**
- 将ffmpeg.exe放在程序同一目录

### 4. 性能优化
- **并发线程数**：建议3-5，过多可能导致网络拥堵
- **无头模式**：建议开启，节省资源
- **代理**：网络不稳定时使用

### 5. 常见问题

#### Q: 程序启动慢？
A: 首次启动需要初始化，属于正常现象。打包后的exe首次运行会更慢。

#### Q: 找不到ChromeDriver？
A: 确保ChromeDriver在PATH中或程序同目录，且版本与Chrome匹配。

#### Q: 下载失败？
A: 
- 检查URL是否正确
- 尝试勾选"强制使用抓包模式"
- 检查网络连接
- 尝试使用代理

#### Q: 视频无法播放？
A: 
- 可能是加密视频，确保勾选"自动解密视频"
- 确保安装了FFmpeg
- 检查视频文件是否完整

#### Q: 合并失败？
A: 
- 确保安装了FFmpeg
- 检查FFmpeg是否在PATH中
- 查看日志了解具体错误

#### Q: 打包后体积大？
A: 
- PyInstaller会打包所有依赖，体积较大是正常的
- 可以使用UPX压缩（在spec文件中已启用）

## 高级配置

### 自定义配置文件
编辑 `config.ini` 来设置默认值：

```ini
[download]
output_dir = downloads
max_downloads = 10
workers = 3

[capture]
headless = true
wait_time = 10
keywords = 1080p,high,quality

[proxy]
enabled = false
http_proxy = http://127.0.0.1:7890

[platforms]
bilibili_decrypt = true
auto_merge = true
```

### 自定义图标
1. 准备一个 `icon.ico` 文件（256x256推荐）
2. 放在项目根目录
3. 重新打包即可

### 添加启动画面
1. 准备一个 `splash.png` 文件
2. 在 `video_downloader.spec` 中取消注释Splash相关代码
3. 重新打包

## 技巧和最佳实践

### 1. 快速开始
- 直接粘贴URL，使用默认设置即可
- 程序会智能检测并选择最佳策略

### 2. 批量下载
- 设置合理的"最大下载数"
- 使用"搜索关键词"过滤不需要的视频
- 适当增加"并发线程数"

### 3. 稳定下载
- 启用"断点续传"
- 网络不稳定时降低"并发线程数"
- 使用代理提高成功率

### 4. 特殊网站
- B站：勾选"强制使用抓包模式"和"自动解密视频"
- YouTube：勾选"强制使用抓包模式"
- HLS流：程序会自动识别，无需特殊设置

### 5. 日志查看
- 实时查看日志了解下载进度
- 出错时查看红色错误信息
- 使用"清空日志"保持界面整洁

## 更新日志

### v4.0 (2026-02-21)
- ✨ 新增GUI可视化界面
- 📦 支持打包成独立exe文件
- 🎨 美观的界面设计
- 📊 实时进度显示
- 📝 彩色日志输出
- ⚙️ 完整的配置选项
- 🚀 一键启动下载

## 技术支持

如有问题，请查看：
- [`README.md`](README.md) - 完整项目文档
- [`EXAMPLES.md`](EXAMPLES.md) - 使用示例
- 日志文件：`logs/` 目录

---

**提示**：GUI版本和命令行版本功能完全相同，可以根据个人喜好选择使用。
